<div class="modal-header" style="background-color:#0071C5">
	<h4 class="modal-title" style="color:white" >Advance Visualization</h4>
</div>

<div class="modal-body" ng-init="getAllFilters()" cg-busy="{promise:metricPromise,templateUrl:'assets/waitLoader.html',message:'', backdrop:true,delay:0,minDuration:0}" ng-cloak>
    
    <div class="md-padding">
        <div style="margin-left:40%;margin-right:40%;margin-top:20px;background-color:#E4E7E9;border-color:black;border-radius:5px;">
        <h5 style="text-align:center;color:#0071C5">Graph Options</h5>
        </div>
        <md-input-container class="md-block" flex-gt-sm style="margin-left:7px; margin-right:10px;" ng-show="avData.y_data.length>1">
          <label style="color:red">**Select Single value in Y-Axis to enable GroupBy Functionality</label>
        </md-input-container>
      	<div layout-gt-sm="row">
          <md-input-container class="md-block" flex= "40" style="margin-left:7px">
            <label>X-Axis</label>
            <md-select ng-model="avData.x_data">
              <md-option ng-repeat="(key,values) in allFilterData">
                {{key}}
              </md-option>
            </md-select>
          </md-input-container>

          <md-input-container class="md-block" flex= "40" style="margin-left:20%; margin-right:10px">
            <label>X-Axis Values</label>
            <md-select ng-model="avData.x_options[avData.x_data]" multiple>
            <md-optgroup style="margin-left:10px">
              <md-checkbox aria-label="Select All"
                         ng-checked=isChecked(avData.x_data,"xData")
                         ng-click="toggleAll(avData.x_data,'xData')">
              <span ng-if="isChecked(avData.x_data,'xData')">Un-</span>Select All
              </md-checkbox>
              <md-option ng-value="value" ng-repeat="value in allFilterData[avData.x_data]" >{{value}}</md-option>
            </md-optgroup>
            </md-select>          
          </md-input-container>
        </div>
        <div layout-gt-sm="row">
          <md-input-container class="md-block" flex-gt-sm style="margin-left:7px; margin-right:10px">
            <label>Y-Axis</label>
            <md-select ng-model="avData.y_data" multiple>
              <md-optgroup>
                <md-option ng-value="measure.name" ng-repeat="measure in data.measures" ng-if="measure.type !== 'percentile' && measure.type !== 'breakup' && measure.type !=='percentage' && measure.type!=='mean'">{{measure.name}}</md-option>
              </md-optgroup>
            </md-select>  
          </md-input-container>
        </div>
        <div layout-gt-sm="row">
          <md-input-container class="md-block" flex-gt-sm style="margin-left:7px; margin-right:10px" ng-hide="avData.y_data.length>1" >
            <label>Group By</label>
            <md-select ng-model="avData.group_by" >
              <md-option ng-repeat="(key,values) in filterSubData" ng-if="key !== avData.x_data" >
                {{key}}
              </md-option>
              <md-option>
                Not Required
              </md-option>
            </md-select>
          </md-input-container>
          
          
        </div>        
    </div>
    <br><br>
    <md-divider style="height: 4px;"></md-divider>

    <div class="md-padding">
      <div style="margin-left:40%;margin-right:40%;background-color:#E4E7E9;border-color:black;border-radius:5px;">
        <h5 style="text-align:center;color:#0071C5">Filter Options</h5>
      </div>
      <!-- <em style="font-weight:bolder;">Filter By</em> -->
      <div layout="row">
        <md-input-container class="md-block" flex="35"  style="margin-left:7px" >
            <label>Category</label>
            <md-select ng-model="tempData.filterkey">
              <md-option ng-repeat="(key,values) in filterSubData" ng-if= "checkobject(key)">
                {{key}}
              </md-option>
            </md-select>
          </md-input-container>
          <md-input-container flex="35"  style="margin-left:5%"  class="md-block">
            <label>Subcategory</label>
            <md-select ng-model="tempData.filters[tempData.filterkey]" multiple>
            <md-optgroup style="margin-left:10px">
              <md-checkbox aria-label="Select All"
                         ng-checked=isChecked(tempData.filterkey,"tempFilter")
                         ng-click="toggleAll(tempData.filterkey,'tempFilter')">
              <span ng-if="isChecked(tempData.filterkey,'tempFilter')">Un-</span>Select All
              </md-checkbox>
              <md-option ng-value="value" ng-repeat="value in filterSubData[tempData.filterkey]" >{{value}}</md-option>
            </md-optgroup>
            </md-select>          
          </md-input-container>
          
          <md-button style="margin-left:15%" class="md-fab md-mini md-primary" ng-click="addFilters(tempData.filters,tempData.filterkey)" aria-label="Add filter"><i class="glyphicon glyphicon-plus"></i></md-button>
          
      </div>
     <div layout="row" ng-repeat="(key,values) in avData.filters" ng-hide="avData.filters==null">
        <md-input-container class="md-block" flex="35" style="margin-left:7px" >
            <label>Category</label>
            <input ng-model="key" disabled>
          </md-input-container>
          <md-input-container flex="35"  style="margin-left:5%">
            <label>Subcategory</label>
            <md-select ng-model="avData.filters[key]" multiple>
            <md-optgroup style="margin-left:10px">
              <md-checkbox aria-label="Select All"
                         ng-checked=isChecked(key,'avFilter')
                         ng-click="toggleAll(key,'avFilter')">
              <span ng-if="isChecked(key,'avFilter')">Un-</span>Select All
              </md-checkbox>
              <md-option ng-value="value" ng-repeat="value in filterSubData[key]">{{value}}</md-option>
            </md-optgroup>
            </md-select>          
          </md-input-container>
          
         <md-button style="margin-left:15%;background-color:#DADDDF;color:#5A5C5A" class="md-fab md-mini" aria-label="Remove filter" ng-click="removeFilters(key)"><i class="glyphicon glyphicon-remove"></i></md-button>
      </div>
    </div>

</div>

<div class="modal-footer">
	<button type="button" class="btn btn-primary" ng-click="save('visualizations')">Apply</button>	
	<button type="button" class="btn btn-default" ng-click="cancel()">Cancel</button>
</div>
